//firebase rules
{
    "rules": {
        "users": {
            //need to check username availability from outside
            ".read": "true",
            "$uid": {
                //only change oneself's user data
                ".write": "$uid === auth.uid",
                "games": {
                    //...but all users can challenge other users
                    ".write": "auth != null"
                }
            },
            ".indexOn": ["displayName", "online"]
        },
        "games": {
            "$gameId": {
                //you can change a game 1) if your uid is set to true, 2) if the game does not exist AND you supply the players of which one is yourself, 3) if you remove the game AND one of the players is you
                ".write": "(auth != null && data.child('players/' + auth.uid).val() == true) || (auth != null && newData.val() == null) || (auth != null && !data.exists() && newData.hasChildren(['players/' + auth.uid]))",
                //you can read a game if you're one of the players.
                ".read": "data.child('players/' + auth.uid).exists()"
            }
        }
    }
}